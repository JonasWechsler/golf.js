<!DOCTYPE html>
<html>
	<head>
		<title>Demo</title>
	</head>
	<body>
        <input type="range" id="maximum_resolution" oninput="regenerate()" onchange = "regenerate()" value="15" min="1" max="20" step="1"><span class="label"></span>
        <input type="range" id="minimum_resolution" oninput="regenerate()" onchange = "regenerate()" value="1" min="1" max = "20" step="1"><span class="label"></span>
        <input type="range" id="seed" oninput="regenerate()" onchange = "regenerate()" value="5" min="1" max = "1000" step="1"><span class="label"></span>
        <input type="range" id="persistance" oninput="regenerate()" onchange = "regenerate()" value=".25" min=".00001" max = ".99999" step=".00001"><span class="label"></span>
        <input type="range" id="max_wavelength" oninput="regenerate()" onchange = "regenerate()" value="500" min="100" max = "2000" step="1"><span class="label"></span>
        <input type="range" id="interpolate" oninput="regenerate()" onchange = "regenerate()" value=".3" min=".00001" max = ".99999" step=".00001"><span class="label"></span>
        <input type="range" id="offset" oninput="redraw()" onchange = "redraw()" value="0" min="-6000" max = "6000" step="1"><span class="label"></span>
        
		<canvas id="draw" class="center">
		</canvas>
		<script src="./built/out.js"></script>
		<script>
			var canvas = document.getElementById("draw");
			var ctx = canvas.getContext("2d");
			canvas.width = 1920;
			canvas.height = 1280;
			var perlin = new WorldGenerators.PerlinGenerator(screen.height);
			var a = new WorldGenerators.PerlinGenerator(3);
			var b = new WorldGenerators.PerlinGenerator(3);
			var c = new WorldGenerators.PerlinGenerator(3);
			a.setSeed(new Date().getHours());
			b.setSeed(new Date().getMinutes());
			c.setSeed(new Date().getSeconds());
			a.setMaxWavelength(6000);
			b.setMaxWavelength(6000);
			c.setMaxWavelength(6000);
			
			function regenerate() {
	    		var max = parseInt(document.getElementById("maximum_resolution").value);
	    		var min = parseInt(document.getElementById("minimum_resolution").value);
	    		var seed = parseInt(document.getElementById("seed").value);
	    		var persistance = parseFloat(document.getElementById("persistance").value);
	    		var max_wavelength = parseInt(document.getElementById("max_wavelength").value);
	    		var interpolate = parseFloat(document.getElementById("interpolate").value);

	    		perlin.setMaximumResolution(max);
	    		perlin.setMinimumResolution(min);
	    		perlin.setSeed(seed);
	    		perlin.setPersistance(persistance);
	    		perlin.setMaxWavelength(max_wavelength);
	    		perlin.setInterpolation(interpolate);

	    		document.getElementsByClassName("label")[0].innerHTML=max;
	    		document.getElementsByClassName("label")[1].innerHTML=min;
	    		document.getElementsByClassName("label")[2].innerHTML=seed;
	    		document.getElementsByClassName("label")[3].innerHTML=persistance;
	    		document.getElementsByClassName("label")[4].innerHTML=max_wavelength;
	    		document.getElementsByClassName("label")[5].innerHTML=interpolate;


	    		document.getElementById("maximum_resolution").min = min;
	    		document.getElementById("minimum_resolution").max = max;
	    		redraw();
			}
			function redraw(){
	    		var offset = parseInt(document.getElementById("offset").value);
				document.getElementsByClassName("label")[6].innerHTML=offset;
	    		ctx.clearRect(0,0,canvas.width, canvas.height);
	    		for(var x=0;x<canvas.width;x++){
	    			ctx.fillStyle="rgb("
	    			 + (100 + 50*Math.floor(a.getHeightAt(x + offset))) + ","
	    			 + (100 + 50*Math.floor(b.getHeightAt(x + offset))) + ","
	    			 + (100 + 50*Math.floor(c.getHeightAt(x + offset))) + ")";
	    			ctx.fillRect(x,perlin.getHeightAt(x + offset),1,canvas.height);
	    			// console.log(perlin.getHeightAt(x));
	    		}
			}
			regenerate();
		</script>
	</body>
</html>